Sub przyporzadkowanie()
'
' przyporzadkowanie Makro
'
Dim lRow As Long
Dim rng As Range
Dim Max As Double
Dim b As Double
Dim nrkol As Double
Dim iCount As Long
Dim i As Long
Dim lp_zmian As Integer


Set rng = Range("D1:D18")
'Worksheet function MAX returns the largest value in a range

Max = Application.WorksheetFunction.Max(rng)
lRow = Application.WorksheetFunction.Match(Max, rng, 0)

MsgBox Max
MsgBox lRow

If Max >= 2700 Then

lp_zmian = Max / 27000
b = lp_zmian + i

MsgBox lp_zmian & b

For i = 1 To b
        Cells(38, 2 * i).Value = 27000
        Cells(38, 2 * b + 2).Value = Max - i * 27000
        Cells(38, 2 * i - 1).Value = Cells(lRow, 1).Value
        Cells(38, 2 * b + 1).Value = Cells(lRow, 1).Value
Next i
 

End If

'End Sub

End Sub
